## Описание проекта

Заранее подготовленное веб-приложение (FRONT) подключается к разработанному сервису без доработок,
а также использует функционал FRONT для авторизации, загрузки и вывода списка файлов пользователя.

Данное приложение представляет собой серверную часть облачного хранилища для файлов.
Разработана на языке Java с помощью фреймворка Spring Boot.

### Описание серверной части

REST-сервис предоставляет интерфейс для возможности загрузки файлов и вывода списка уже загруженных файлов пользователя
по [заранее описанной спецификации](CloudServiceSpecification.yaml).

Все запросы к сервису авторизованы.

### Функционал серверной части
+ Отображение загруженных файлов;
+ загрузка файлов;
+ скачивание файлов;
+ удаление файлов;
+ смена имени файлов;
+ аутентификация и авторизация (первичная - с вводом логина и пароля,
  в дальнейшем - при каждом запросе при помощи токена в заголовках).

### Используемый стэк
+ Spring Boot;
+ Spring Security;
+ Maven;
+ Docker, Docker Compose;
+ Lombok;
+ Logback;
+ MapStruct;
+ Redis;
+ PostgreSQL;
+ Liquibase.

### Тесты
Для основных функциональных модулей написаны тесты с использованием:
+ JUnit;
+ Mockito;
+ AssertJ;
+ TestContainers (интеграционные тесты).

## Запуск приложения

### Запуск FRONT:

1. скачать [FRONT](https://github.com/netology-code/jd-homeworks/tree/master/diploma/netology-diplom-frontend) (JavaScript) и распаковать его в локальную папку;
2. установить nodejs 16.17 на компьютер [следуя инструкции](https://nodejs.org/ru/download/);
3. перейти в папку FRONT приложения и все команды для запуска выполнять из нее;
4. следуя описанию README.md FRONT проекта запустить nodejs приложение (npm install...);
5. для запуска FRONT приложения с расширенным логированием использовать команду: `npm run serve`.

#### Авторизация приложения:
FRONT приложение использует header `auth-token` в котором отправляет токен (ключ-строка) для идентификации пользователя на BACKEND.
Для получения токена нужно пройти авторизацию на BACKEND и отправить на метод /login пару логин и пароль, в случае успешной проверки в ответ BACKEND должен вернуть json объект
с полем `auth-token` и значением токена. Все дальейшие запросы с FRONTEND, кроме метода /login отправляются с этим header.
Для выхода из приложения нужно вызвать метод BACKEND /logout, который удалит/деактивирует токен и последующие запросы с этим токеном будут не авторизованы и возвращать код 401.

### Запуск BACKEND:

- скачать данный проект;
- запустить Docker Desktop;
- открыть проект в среде разработки IntelliJ IDEA;
- собрать jar файл можно двумя способами:
  1. Запускаем терминал в папке  `/myCloud` и собираем jar архив с нашим Spring REST приложением с помощью команд:
        ```mvn clean package -Dskiptests``` и ```mvn clean package -Dmaven.test.skip```;
  2. Во вкладке Maven активируем иконку `Togger 'Skip Tests' Mode`, в катлоге `Lifecycle` по очередно активировать команды `clear` затем `package`;
- после успешной сборки в папке будет находиться jar файл:`cloud-0.0.1-SNAPSHOT.jar`;
- в терминале выполнить команду по сборке images и containers: ```docker-compose up```.
В результате в соответствии с Dockerfile`ом будет создан и запущен контейнер, 
содержащий в себе сам REST-сервис, и запустяться три приложения:
  1. postgreSQL, СУБД для хранения пользователей и файлов на сервере: ```http://localhost:5432```;
  2. redis, noSQL для хранения токена и логина пользователя: ```http://localhost:6379```; 
  3. app, REST сервис: ```http://localhost:8080```;

Теперь можно отправлять запросы с клиента, развернув его локально и предварительно прописав в файле .env
строку VUE_APP_BASE_URL=http://localhost:8080

### Учетные данные для входа
+ user@user.ru, user - имеет доступ только к скачиванию и просмотру файлов
+ admin@admin.ru, admin - имеет доступ ко всему функционалу